import{r as n,j as e}from"./app-1-J-Rkvr.js";import{c as O,B as h,L as c,I as u}from"./label-BV62W-PP.js";import{C as K,a as G}from"./card-BY_Q-Zm1.js";import{D as S,g as Q,a as M,b as I,c as F,M as X}from"./Footer-D5nGiAW4.js";import{T as Y}from"./textarea-Dah2xFhi.js";import{u as Z}from"./use-toast-BCIsxhQE.js";import{P as b,S as ee,D as ae}from"./delete-confirmation-CNbCtFkH.js";import{I as se,E as te,T as re}from"./image-uploader-B8Gleyuh.js";import{D as ie}from"./database-error-D1QB9TqC.js";import{A as ne}from"./AdminLayout-nImAOwRT.js";import"./index-B_wQ5iga.js";import"./circle-alert-CTpRWOly.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],L=O("linkedin",le);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],$=O("twitter",oe),j="http://localhost:8000/api",ce=j.replace("/api",""),_=i=>i?i.startsWith("data:")||i.startsWith("http")?i:`${ce}${i}`:"/placeholder.svg";function de(){const[i,A]=n.useState([]),[z,y]=n.useState(!0),[k,E]=n.useState(null),[B,f]=n.useState(!1),[R,C]=n.useState(!1),[U,g]=n.useState(!1),[l,D]=n.useState(null),[s,q]=n.useState(null),[T,w]=n.useState(null),[t,p]=n.useState({name:"",role:"",bio:"",email:"",image:"",linkedin:"",twitter:""}),{toast:x}=Z(),v=async()=>{y(!0),E(null);try{const a=await fetch(`${j}/team`);if(!a.ok)throw new Error("Failed to fetch team members");const r=await a.json();A(r)}catch(a){console.error("Error fetching team members:",a),E("Failed to fetch team members from database")}finally{y(!1)}};n.useEffect(()=>{v()},[]);const d=a=>{const{name:r,value:o}=a.target;p(m=>({...m,[r]:o}))},P=a=>{p(r=>({...r,image:a}))},V=async a=>{a.preventDefault();try{if(!t.name||!t.role){x({title:"Missing Required Fields",description:"Name and Role are required for a team member.",variant:"destructive"});return}const r={name:t.name,role:t.role,bio:t.bio,email:t.email,image:t.image,linkedin:t.linkedin||null,twitter:t.twitter||null,order_index:(l==null?void 0:l.order_index)||i.length+1,active:!0};console.log("Saving team member with data:",r);const o=localStorage.getItem("adminToken");if(!o)throw new Error("No authentication token found. Please log in again.");let m;if(l?m=await fetch(`${j}/team/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(r)}):m=await fetch(`${j}/team`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(r)}),!m.ok){const H=await m.json();throw new Error(H.message||"Failed to save team member")}x({title:l?"Team Member Updated":"Team Member Created",description:`"${t.name}" has been ${l?"updated":"added"} successfully.`}),N(),f(!1),v()}catch(r){console.error("Error saving team member:",r),x({title:"Error",description:r.message||"Failed to save team member",variant:"destructive"})}},N=()=>{p({name:"",role:"",bio:"",email:"",image:"",linkedin:"",twitter:""}),D(null)},J=a=>{D(a),p({name:a.name||"",role:a.role||"",bio:a.bio||"",email:a.email||"",image:a.image||"",linkedin:a.linkedin||"",twitter:a.twitter||""}),f(!0)},W=async()=>{if(T)try{const a=localStorage.getItem("adminToken");if(!a)throw new Error("No authentication token found. Please log in again.");const r=await fetch(`${j}/team/${T}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!r.ok){const o=await r.json();throw new Error(o.message||"Failed to delete team member")}x({title:"Team Member Deleted",description:"The team member has been deleted successfully."}),v()}catch(a){console.error("Error deleting team member:",a),x({title:"Error",description:a.message||"Failed to delete team member",variant:"destructive"})}finally{g(!1),w(null)}};return z?e.jsxs("div",{className:"flex items-center justify-center py-20",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#e51083]"}),e.jsx("p",{className:"ml-4 text-gray-600 dark:text-gray-400",children:"Loading team members..."})]}):k?e.jsx(ie,{message:k}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Team Management"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Manage team members and their information"})]}),e.jsxs(S,{open:B,onOpenChange:f,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(h,{onClick:N,children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New Team Member"]})}),e.jsxs(M,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(I,{children:e.jsx(F,{children:l?"Edit Team Member":"Add New Team Member"})}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"name",children:"Name *"}),e.jsx(u,{id:"name",name:"name",value:t.name,onChange:d,placeholder:"Enter full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"role",children:"Role *"}),e.jsx(u,{id:"role",name:"role",value:t.role,onChange:d,placeholder:"Enter role/position",required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"email",children:"Email"}),e.jsx(u,{id:"email",name:"email",type:"email",value:t.email,onChange:d,placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"linkedin",children:"LinkedIn URL"}),e.jsx(u,{id:"linkedin",name:"linkedin",value:t.linkedin,onChange:d,placeholder:"https://linkedin.com/in/username"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"twitter",children:"Twitter URL"}),e.jsx(u,{id:"twitter",name:"twitter",value:t.twitter,onChange:d,placeholder:"https://twitter.com/username"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(c,{children:"Profile Image"}),e.jsx(se,{currentImage:t.image,onImageSelected:P,aspectRatio:"1:1"})]})})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"bio",children:"Biography"}),e.jsx(Y,{id:"bio",name:"bio",value:t.bio,onChange:d,placeholder:"Enter biography",rows:4})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>{N(),f(!1)},children:"Cancel"}),e.jsx(h,{type:"submit",children:l?"Update Member":"Add Member"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(a=>e.jsx(K,{className:"overflow-hidden",children:e.jsx(G,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden mb-4 bg-gray-100",children:a.image?e.jsx("img",{src:_(a.image),alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(b,{className:"h-8 w-8"})})}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:a.role}),a.bio&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3",children:a.bio}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[a.email&&e.jsx("a",{href:`mailto:${a.email}`,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})}),a.linkedin&&e.jsx("a",{href:a.linkedin,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-blue-600 transition-colors",children:e.jsx(L,{className:"h-4 w-4"})}),a.twitter&&e.jsx("a",{href:a.twitter,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-blue-400 transition-colors",children:e.jsx($,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{q(a),C(!0)},children:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>J(a),children:e.jsx(ee,{className:"h-3 w-3"})}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{w(a.id),g(!0)},children:e.jsx(re,{className:"h-3 w-3"})})]})]})})},a.id))}),e.jsx(S,{open:R,onOpenChange:C,children:e.jsxs(M,{className:"max-w-2xl",children:[e.jsx(I,{children:e.jsx(F,{children:s==null?void 0:s.name})}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gray-100",children:s.image?e.jsx("img",{src:_(s.image),alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(b,{className:"h-6 w-6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.role}),s.email&&e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]})]}),s.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Biography"}),e.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:s.bio})]}),(s.linkedin||s.twitter)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Social Links"}),e.jsxs("div",{className:"flex space-x-4",children:[s.linkedin&&e.jsxs("a",{href:s.linkedin,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-blue-600 hover:underline",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"LinkedIn"})]}),s.twitter&&e.jsxs("a",{href:s.twitter,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-blue-400 hover:underline",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:"Twitter"})]})]})]})]})]})}),e.jsx(ae,{isOpen:U,onClose:()=>{g(!1),w(null)},onConfirm:W,itemName:"team member"})]})}de.layout=i=>e.jsx(ne,{children:i});export{de as default};
