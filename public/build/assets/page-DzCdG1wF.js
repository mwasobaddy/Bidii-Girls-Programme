import{r as n,a as j,j as e}from"./app-1-J-Rkvr.js";import{c as S,B as _}from"./label-BV62W-PP.js";import{C as D,a as I}from"./card-BY_Q-Zm1.js";import{D as B,I as b}from"./database-error-D1QB9TqC.js";import{C as k,A as T}from"./AdminLayout-nImAOwRT.js";import{U as x,f as P}from"./Footer-D5nGiAW4.js";import"./index-B_wQ5iga.js";import"./circle-alert-CTpRWOly.js";import"./use-toast-BCIsxhQE.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],f=S("newspaper",L);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],M=S("tag",R);function U({children:t}){const[r,c]=n.useState(!1),[l,g]=n.useState(!0);return n.useEffect(()=>{const d=localStorage.getItem("adminToken"),m=localStorage.getItem("adminUser");if(!d||!m){j.visit("/admin/login");return}c(!0),g(!1)},[]),l?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-[#e51083]"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Checking authentication..."})]})}):r?t:null}const A="http://localhost:8000/api",C=()=>({"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`}),F=async()=>{try{const t=await fetch(`${A}/admin/dashboard/stats`,{headers:C()});if(!t.ok)throw new Error("Failed to fetch dashboard stats");return{success:!0,data:await t.json()}}catch(t){return console.error("Error fetching dashboard stats:",t),{success:!1,message:t.message}}},$=async()=>{try{const t=await fetch(`${A}/admin/dashboard/activity`,{headers:C()});if(!t.ok)throw new Error("Failed to fetch recent activity");return{success:!0,data:await t.json()}}catch(t){return console.error("Error fetching recent activity:",t),{success:!1,message:t.message}}};function G(){const[t,r]=n.useState({sponsors:0,projects:0,campaigns:0,stories:0,blog:0,gallery:0,team:0,categories:0}),[c,l]=n.useState([]),[g,d]=n.useState(!0),[m,y]=n.useState(null);return n.useEffect(()=>{(async()=>{var v,w,N;d(!0),y(null);try{await new Promise(i=>setTimeout(i,100));const[s,h]=await Promise.all([F(),$()]);if(s.success)r(i=>({...i,...s.data,sponsors:s.data.sponsors||0,projects:s.data.projects||0,campaigns:s.data.campaigns||0,stories:s.data.stories||0,blog:s.data.blog||0,gallery:s.data.gallery||0,team:s.data.team||0,categories:s.data.categories||0}));else throw console.error("Stats response:",s),new Error(s.message||"Failed to fetch dashboard stats");if(h.success){const i=[];let p=1;(v=h.data.recent_blogs)==null||v.forEach(a=>{i.push({id:p++,type:"blog post",action:"created",itemName:a.title,timestamp:a.created_at})}),(w=h.data.recent_projects)==null||w.forEach(a=>{i.push({id:p++,type:"project",action:"created",itemName:a.title,timestamp:a.created_at})}),(N=h.data.recent_campaigns)==null||N.forEach(a=>{i.push({id:p++,type:"campaign",action:"created",itemName:a.title,timestamp:a.created_at})}),i.sort((a,E)=>new Date(E.timestamp).getTime()-new Date(a.timestamp).getTime()),l(i.slice(0,10))}}catch(s){console.error("Error fetching dashboard data:",s),y("Failed to load dashboard data")}finally{d(!1)}})()},[]),g?e.jsxs("div",{className:"flex items-center justify-center py-20",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#e51083]"}),e.jsx("p",{className:"ml-4 text-gray-600 dark:text-gray-400",children:"Loading dashboard..."})]}):m?e.jsx(B,{message:m}):e.jsx(U,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Overview of your website's content and recent activity"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(o,{title:"Sponsors",value:String(t.sponsors||0),icon:e.jsx(x,{className:"h-5 w-5 text-blue-600"}),link:"/admin/sponsors"}),e.jsx(o,{title:"Projects",value:String(t.projects||0),icon:e.jsx(k,{className:"h-5 w-5 text-green-600"}),link:"/admin/projects"}),e.jsx(o,{title:"Campaigns",value:String(t.campaigns||0),icon:e.jsx(f,{className:"h-5 w-5 text-yellow-600"}),link:"/admin/campaigns"}),e.jsx(o,{title:"Stories",value:String(t.stories||0),icon:e.jsx(P,{className:"h-5 w-5 text-purple-600"}),link:"/admin/stories"}),e.jsx(o,{title:"Blog Posts",value:String(t.blog||0),icon:e.jsx(f,{className:"h-5 w-5 text-blue-600"}),link:"/admin/blog"}),e.jsx(o,{title:"Gallery",value:String(t.gallery||0),icon:e.jsx(b,{className:"h-5 w-5 text-pink-600"}),link:"/admin/gallery"}),e.jsx(o,{title:"Team Members",value:String(t.team||0),icon:e.jsx(x,{className:"h-5 w-5 text-indigo-600"}),link:"/admin/team"}),e.jsx(o,{title:"Categories",value:String(t.categories||0),icon:e.jsx(M,{className:"h-5 w-5 text-red-600"}),link:"/admin/categories"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(u,{title:"Add Sponsor",icon:e.jsx(x,{className:"h-5 w-5"}),href:"/admin/sponsors"}),e.jsx(u,{title:"New Project",icon:e.jsx(k,{className:"h-5 w-5"}),href:"/admin/projects"}),e.jsx(u,{title:"Write Blog Post",icon:e.jsx(f,{className:"h-5 w-5"}),href:"/admin/blog"}),e.jsx(u,{title:"Upload Gallery Image",icon:e.jsx(b,{className:"h-5 w-5"}),href:"/admin/gallery"})]})]})})}function o({title:t,value:r,icon:c,link:l}){return e.jsx("div",{onClick:()=>j.visit(l),className:"cursor-pointer",children:e.jsx(D,{className:"hover:shadow-md transition-shadow h-full",children:e.jsx(I,{className:"pt-6 h-full",children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t}),e.jsx("p",{className:"text-2xl font-bold",children:r})]}),e.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded-lg",children:c})]})})})})}function u({title:t,icon:r,href:c}){return e.jsxs(_,{variant:"outline",className:"w-full justify-start h-12",onClick:()=>j.visit(c),children:[e.jsx("div",{className:"mr-3",children:r}),t]})}G.layout=t=>e.jsx(T,{children:t});export{G as default};
